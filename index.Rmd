---
output:
  html_document:
    theme: spacelab
---

A guided example showing how processed results from the RNAseq pipeline [SPEAQeasy](https://github.com/LieberInstitute/SPEAQeasy) can be used in differential expression analyses and visualization. We also show how existing genotype information for a set of samples can be combined with SPEAQeasy results to resolve any identity issues, as can emerge during sequencing.

* [Downloading the example data](TODO: link markdown file walking through this process)
* [Run SPEAQeasy on your setup](TODO: link brief markdown file- also mention just using our outputs)
* [Resolve identity issues and attach phenotype data](TODO: Rmd file for this)
* [Perform differential expression and visualize results](DE_analysis/de_analysis_speaqeasy.Rmd)

# References

```{r 'setup', echo = FALSE, warning = FALSE, message = FALSE}
## Bib setup
library('knitcitations')
library('BiocStyle')

## Load knitcitations with a clean bibliography
cleanbib()
cite_options(hyperlink = 'to.doc', citation_format = 'text', style = 'html')

## Write bibliography information
bibs <- c(
    SummarizedExperiment = citation('SummarizedExperiment'),
    recount = citation('recount'),
    edgeR = citation('edgeR'),
    limma = citation('limma'),
    jaffelab = citation('jaffelab'),
    RColorBrewer = citation('RColorBrewer'),
    clusterProfiler = citation('clusterProfiler'),
    org.Hs.eg.db = citation('org.Hs.eg.db'),
    pheatmap = citation('pheatmap'),
    R = citation(),
    voom = RefManageR::BibEntry('article', key = 'voom', author = 'CW Law and Y Chen and W Shi and GK Smyth', year = '2014', title = 'Voom: precision weights unlock linear model analysis tools for RNA-seq read counts', journal = 'Genome Biology', volume = '15', pages = 'R29')
)

write.bibtex(bibs, file = 'index.bib')
bib <- read.bibtex('index.bib')

## Assign short names
names(bib) <- names(bibs)
```

The analysis was possible thanks to R and many of its packages:

* R `r citep(bib[['R']])`
* `r citep(bib[['SummarizedExperiment']])`
* `r citep(bib[['recount']])`
* `r citep(bib[['edgeR']])`
* `r citep(bib[['limma']])`
* `r citep(bib[['jaffelab']])`
* `r citep(bib[['RColorBrewer']])`
* `r citep(bib[['clusterProfiler']])`
* `r citep(bib[['org.Hs.eg.db']])`
* `r citep(bib[['pheatmap']])`
* `r citep(bib[['voom']])`

[Bibliography file](index.bib)

```{r bibliography, results='asis', echo=FALSE, warning = FALSE, message = FALSE}
## Print bibliography
bibliography()
```