---
output:
  html_document:
    theme: spacelab
---

```{r}
library(SummarizedExperiment)
```


## Swap samples identified in Brain Swap project
5: Br2260: 9373406026_R01C01
$`Lims Phenotype Info`
     BrNum sex agedeath primarydx race
854 Br2260   F    45.51   Bipolar CAUC
972 Br2473   F    52.61   Bipolar CAUC

$BrNum
[1] "Br2260" "Br2473"

$`Flag index`
[1] 5 9

$`Genotype data`
                    ID  BrNum bestCor bestCorBr           bestCorID nBr_samp genoSex bestcorSex
189  9373408026_R01C01 Br2473   0.271    Br8067 201962800059_R05C01        1       F          M
1241 9373406026_R01C01 Br2260   0.251    Br1546   4572348603_R01C02        1       F          F

$`RNA data`
    cor genoBr        genoSample  rnaBr        rnaSample genoChip rnaRegion     rnaDataset genoSex rnaSex
1 0.920 Br2260 9373406026_R01C01 Br2473 R14077_HCTYLBBXX       5M  Amygdala psychENCODE_BP       F      F
2 0.921 Br2260 9373406026_R01C01 Br2473 R14296_H7JLCBBXX       5M      sACC psychENCODE_BP       F      F
3 0.899 Br2473 9373408026_R01C01 Br2260 R14071_HF3JYBBXX       5M  Amygdala psychENCODE_BP       F      F
4 0.951 Br2473 9373408026_R01C01 Br2260 R14290_H7L3FBBXX       5M      sACC psychENCODE_BP       F      F

10: Br2486: 9373408026_R02C01
$`Lims Phenotype Info`
     BrNum sex agedeath primarydx race
864 Br2275   F    45.03   Bipolar CAUC
979 Br2486   M    46.73    Schizo   AA

$BrNum
[1] "Br2275" "Br2486"

$`Flag index`
[1]  10 100 101

$`Genotype data`
                      ID  BrNum bestCor bestCorBr           bestCorID nBr_samp genoSex bestcorSex
48     9373408026_R02C01 Br2486   0.995    Br2275 201398400130_R06C01        1       F          F
1892   9373406026_R02C01 Br2275   0.324    Br5085   8501651024_R04C01        2       M          F
1958 201398400130_R06C01 Br2275   0.995    Br2486   9373408026_R02C01        2       F          F

$`RNA data`
    cor genoBr          genoSample  rnaBr        rnaSample   genoChip rnaRegion     rnaDataset genoSex rnaSex
1 0.961 Br2275 201398400130_R06C01 Br2275 R13997_H7JHNBBXX 2-5-8-v1-3  Amygdala psychENCODE_BP       F      F
2 0.956 Br2275 201398400130_R06C01 Br2275 R14222_H7JHNBBXX 2-5-8-v1-3      sACC psychENCODE_BP       F      F
3 0.956 Br2486   9373408026_R02C01 Br2275 R14222_H7JHNBBXX         5M      sACC psychENCODE_BP       F      F
4 0.961 Br2486   9373408026_R02C01 Br2275 R13997_H7JHNBBXX         5M  Amygdala psychENCODE_BP       F      F

## List swap samples
```{r}
swap_ID <- c("R14077_HCTYLBBXX","R14296_H7JLCBBXX","R14071_HF3JYBBXX","R14290_H7L3FBBXX","R13997_H7JHNBBXX","R14222_H7JHNBBXX")
swap_case <- c(rep("swap_simple",4),rep("swap_complex", 2))
swap_df <- data.frame(swap_ID, swap_case)
colnames(swap_df) <- c("SAMPLE_ID", "SwapCase")
swap_df
```

## Load Data
fastq files found in /dcl02/lieber/ajaffe/Nina/Zandi/data
```{r}
## zandi/hyde bipolar
load("/dcl01/lieber/ajaffe/lab/zandiHyde_bipolar_rnaseq/data/zandiHypde_bipolar_rseGene_n511.rda", verbose = TRUE)

manifest <- read.delim("/dcl01/lieber/ajaffe/lab/zandiHyde_bipolar_rnaseq/preprocessed_data/.samples_unmerged.manifest", header = FALSE)
head(manifest)
#change to dcl02, same relative path after
manifest<- data.frame(lapply(manifest, function(x) {gsub("dcl01", "dcl02", x)}))
```

## Check Phenotype data of swap samples
All 3 individuals the samples are from are F, 45+, Cauc, and Bipolar
```{r}
pd <- colData(rse_gene)[,c("SAMPLE_ID","RNum","BrNum","BrainRegion","Sex","AgeDeath","Race","PrimaryDx","RIN")]
head(pd)
subset(pd, SAMPLE_ID %in% swap_ID)
```

## Select samples
want 40 samples in the final data set, after 2 samples from the complex swap aer dropped
balance across Dx, Region, Sex, similar mean in Age
```{r}
pd_swap <- merge(swap_df, pd)

#all other samples
pd_other <- subset(pd, !SAMPLE_ID %in% swap_ID)
dim(pd_other)
#check for all adult samples
summary(pd_other$AgeDeath)
  #  Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  # 17.37   35.34   47.09   47.18   56.05   86.76 

```



